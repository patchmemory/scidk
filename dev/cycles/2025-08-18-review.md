# Cycle Review and Plan Consolidation — 2025-08-18

This report consolidates the review of dev/cycles.md and related task specs, captures what was executed during the current cycle, and records the selected plan for the upcoming cycle. It turns prior scratch planning into a durable in-repo artifact.

## Summary
- The project follows a GUI-first weekly cadence with max 5 tasks per cycle, DoR/DoD checklists, and a Demo Checklist.
- Current cycle delivered: directories registry + UI placement, JSON/YAML/CSV interpreters, search API + Home search UI, and tests hardening.
- Neo4j adapter migration plan is documented in dev/ops/deployment-neo4j.md.
- Added tests to harden /api/search edge cases (empty query, case-insensitivity). All tests pass.

## Current Cycle (2025-08-18 → 2025-08-23) — Executed
- E2E Objectives achieved:
  - Home lists Scanned Directories; Files page hosts Scan form.
  - /api/directories returns session directories.
  - Interpreters page renamed and functional; legacy /extensions redirects.
  - JSON/YAML/CSV interpreters integrated; dataset detail shows summaries.
  - /api/search returns datasets by filename/path and interpreter_id; Home search UI wired up.
- Artifacts touched:
  - Code: scidk/app.py, scidk/ui/templates/index.html, scidk/ui/templates/datasets.html, scidk/interpreters/*.py
  - Docs: dev/features/ui/feature-files-page-and-scanned-sources.md, dev/features/interpreters/feature-txt-xlsx-interpreters.md, dev/features/core-architecture/feature-search-index.md, dev/features/core-architecture/feature-directories-registry-and-api.md, dev/ops/deployment-neo4j.md
  - Tests: tests/test_directories_api.py, tests/test_search_api.py
- Tests added:
  - test_api_search_empty_query_returns_empty_list
  - test_api_search_case_insensitive

## Proposed Next Cycle (2025-08-26 → 2025-08-30)
Theme: Basic Search (UI-visible) + Neo4j Adapter Prep

- E2E Objective
  A user can search datasets by filename or interpreter on Home, and we have a documented, verifiable adapter boundary with a feature flag plan (dev/ops/deployment-neo4j.md).

- Capacity
  24h (single agent)

- GUI Acceptance
  - Home page search returns datasets via /api/search.
  - dev/ops/deployment-neo4j.md contains a “Migration Plan” (adapter interface + feature flags).

- Selected Tasks (max 5)
  1) task:core-architecture/mvp/search-index — Thin index powering /api/search
     - DoR: Route exists; validate and polish behaviors
     - DoD: pytest covers filename/interpreter_id; UI verified
     - Relevant: dev/features/core-architecture/feature-search-index.md; scidk/app.py; templates/index.html; tests/test_search_api.py
  2) task:ui/mvp/home-search-ui — Home search box + results
     - DoR: API ready
     - DoD: Browser-usable; links navigate to dataset detail; demo steps recorded
     - Relevant: templates/index.html; dev/cycles.md; README
  3) task:core-architecture/mvp/neo4j-adapter-prep — Adapter boundary + migration plan (polish/cross-link)
     - DoR: Plan present
     - DoD: dev/ops/deployment-neo4j.md section validated and cross-linked
     - Relevant: dev/ops/deployment-neo4j.md; dev/features/core-architecture/feature-graph-adapter-boundary.md
  4) task:core-architecture/mvp/tests-hardening — Fill gaps discovered during validation
     - DoR: Identify missing tests (edge cases)
     - DoD: Added tests pass; no flakiness
     - Relevant: dev/tasks/core-architecture/mvp/task-tests-hardening.md; tests/test_search_api.py
  5) task:ops/mvp/error-toasts — Small UX polish (cut first if constrained)
     - DoD: Client-side notification for API errors (search/chat)
     - Relevant: templates/base.html or inline JS; static assets

- Dependencies
  - ui/mvp/home-search-ui depends on core-architecture/mvp/search-index

- Risks & Cut Lines
  - Cut order: (5) ops polish → (4) tests follow-ups → non-essential search snippets
  - Mitigation: Keep search index minimal (filename, extension, interpreter_id)

- Demo Checklist
  1) Start app
  2) POST /api/scan with a small dir containing .py, .csv, .json, .yaml
  3) Home: search by filename and by interpreter_id (e.g., python_code, csv) and verify results are clickable
  4) Open dev/ops/deployment-neo4j.md and verify the “Migration Plan” section

## Mapping: Tasks → Files/Docs
- core-architecture/mvp/search-index
  - dev/features/core-architecture/feature-search-index.md
  - scidk/app.py (/api/search)
  - templates/index.html (search UI)
  - tests/test_search_api.py
- ui/mvp/home-search-ui
  - templates/index.html; dev/cycles.md
- core-architecture/mvp/neo4j-adapter-prep
  - dev/ops/deployment-neo4j.md; dev/features/core-architecture/feature-graph-adapter-boundary.md
- core-architecture/mvp/tests-hardening
  - dev/tasks/core-architecture/mvp/task-tests-hardening.md; tests/*
- ui/mvp/files-scan-ui-and-home-directories
  - templates/index.html; templates/datasets.html; scidk/app.py
- ui/mvp/rename-extensions-to-interpreters
  - scidk/app.py; templates/extensions.html; dev/tasks/ui/mvp/task-rename-extensions-to-interpreters.md
- interpreters/mvp/json-yaml
  - scidk/interpreters/json_interpreter.py; scidk/interpreters/yaml_interpreter.py; dev/features/interpreters/feature-json-yaml-interpreters.md

## DoR/DoD Checklists
- DoR (for selected tasks)
  - Outcome and GUI acceptance written; dependencies noted; test approach stated; owner/time estimate captured; acceptance data source listed.
- DoD (across tasks)
  - Tests green; docs updated; demo path recorded; weekly demo tag created (mvp-iter-2025-08-26-0900 or similar).

## Next Steps
- Tag to create: mvp-iter-2025-08-26-0900
- Proceed with validation/polish of /api/search and UI (already largely complete), ensure docs cross-links remain accurate, and add any minor missing tests discovered.

## Execution Progress (2025-08-18)
- Implemented minimal error-toasts utility in templates/base.html and updated Home page (index.html) to use toasts for Chat and Search API errors. This satisfies the optional ops polish item for the next cycle while keeping scope minimal. Tests remain green.

## Addendum — 2025-08-21
Since this review, the following were delivered and are now reflected in README and code:
- ProviderRegistry with LocalFS and MountedFS providers; feature flag SCIDK_PROVIDERS.
- APIs: /api/providers, /api/provider_roots, /api/browse; /api/scan accepts provider_id (legacy defaults to local_fs).
- UI: Files page consolidated (provider selector, roots, path input, browser table, scan action). Home shows “Scanned Sources.” Settings page exposes Neo4j config with connect/disconnect.
- Interpreters: TXT and XLSX added (along with Python, CSV, JSON, YAML, IPYNB already registered). Rule-based selection in place.
- Neo4j: Optional schema endpoints and a Commit-to-Graph flow with post-commit verification; mocked-driver unit test added.

See also: dev/stories/providers-mvp-multi-source-files/story.md (Status: In progress).
